(()=>{"use strict";var e,t="https://js.stripe.com/v3",r=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,n="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",o=function(e){var r=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",n=document.createElement("script");n.src="".concat(t).concat(r);var o=document.head||document.body;if(!o)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return o.appendChild(n),n},i=null,s=null,a=null,c=!1,l=function(){return e||(e=(c=null,null!==i?i:(i=new Promise((function(e,i){if("undefined"!=typeof window&&"undefined"!=typeof document)if(window.Stripe&&c&&console.warn(n),window.Stripe)e(window.Stripe);else try{var l=function(){for(var e=document.querySelectorAll('script[src^="'.concat(t,'"]')),n=0;n<e.length;n++){var o=e[n];if(r.test(o.src))return o}return null}();if(l&&c)console.warn(n);else if(l){if(l&&null!==a&&null!==s){var d;l.removeEventListener("load",a),l.removeEventListener("error",s),null===(d=l.parentNode)||void 0===d||d.removeChild(l),l=o(c)}}else l=o(c);a=function(e,t){return function(){window.Stripe?e(window.Stripe):t(new Error("Stripe.js not available"))}}(e,i),s=function(e){return function(){e(new Error("Failed to load Stripe.js"))}}(i),l.addEventListener("load",a),l.addEventListener("error",s)}catch(e){return void i(e)}else e(null)}))).catch((function(e){return i=null,Promise.reject(e)}))).catch((function(t){return e=null,Promise.reject(t)})));var c};Promise.resolve().then((function(){return l()})).catch((function(e){c||console.warn(e)}));const d=(()=>{let e,t,r,n,o,i,s=!1;const a=e=>{const t=`<div class="learn-press-message error">${e}</div>`;n.insertAdjacentHTML("afterbegin",t),n.scrollIntoView({behavior:"smooth"})};return{init:async()=>{if("undefined"==typeof lpStripeSetting&&console.log("LP Stripe Setting is not defined"),void 0!==lpStripeSetting.payment_stripe_via_iframe)if(void 0===lpStripeSetting.error)n=document.getElementById("learn-press-checkout"),t=document.getElementById("learn-press-checkout-form"),t&&await(async()=>{try{e=await function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];c=!0;var n=Date.now();return l().then((function(e){return function(e,t,r){if(null===e)return null;var n=e.apply(void 0,t);return function(e,t){e&&e._registerWrapper&&e._registerWrapper({name:"stripe-js",version:"3.4.1",startTime:t})}(n,r),n}(e,t,n)}))}(lpStripeSetting.publish_key||"");const t={clientSecret:lpStripeSetting.publishableKey||"",appearance:{}};r=e.elements(t);const n=r.create("payment");n.on("loaderror",(function(e){i=e.error.message})),n.on("ready",(function(e){s=!0})),n.mount("#lp-stripe-payment-form")}catch(e){i=e.message}})();else{const e=document.querySelector(".payment_method_stripe");e&&e.insertAdjacentHTML("afterbegin",`<span class="error" style="color: #e01618">Error: ${lpStripeSetting.error}</span>`)}},events:()=>{document.addEventListener("click",(function(c){const l=c.target;if("learn-press-checkout-place-order"===l.id){const d=l;if(t=document.getElementById("learn-press-checkout-form"),!t)return;const u=new FormData(t);if("stripe"!==u.get("payment_method"))return;if(c.preventDefault(),!n)return void console.error("Page checkout is not defined");const p=n.querySelectorAll(".learn-press-message.error");if(p.length>0&&p.forEach((e=>{e.remove()})),void 0!==i)return void a(i);if(void 0===lpStripeSetting.publishableKey)return void a("Stripe Publish Key is generate failed, please check again config key!");if(!s)return void a("Stripe payment not load done. Please wait!");r.submit().then((function(t){void 0===t.error&&(d.classList.add("loading"),d.disabled=!0,d.innerText=lpCheckoutSettings.i18n_processing,o=new URL(lpCheckoutSettings.ajaxurl),o.searchParams.set("lp-ajax","checkout"),((e,t={})=>{fetch(o,{method:"POST",body:e}).then((e=>e.text())).then((e=>{e=(e=>{if("string"!=typeof e)return e;const t=String.raw({raw:e}).match(/<-- LP_AJAX_START -->(.*)<-- LP_AJAX_END -->/s);try{e=t?JSON.parse(t[1].replace(/(?:\r\n|\r|\n)/g,"")):JSON.parse(e)}catch(t){e={}}return e})(e),t.success(e)})).finally((()=>{t.completed()})).catch((e=>t.error(e)))})(u,{before:()=>{},success:t=>{var n,o;"fail"===t.result?(d.classList.remove("loading"),d.disabled=!1,d.innerText=lpCheckoutSettings.i18n_place_order,a(t.messages)):"processing"===t.result&&(d.innerText=lpCheckoutSettings.i18n_redirecting,n=t.redirect,o=e=>{console.log(e),e.error&&(d.classList.remove("loading"),d.disabled=!1,d.innerText=lpCheckoutSettings.i18n_place_order,a(e.error.message))},void 0===e&&console.log("Stripe is not defined"),void 0===r&&console.log("Stripe form not mounted"),e.confirmPayment({elements:r,confirmParams:{return_url:n}}).then((function(e){o(e)})))},error:e=>{},completed:()=>{}}))}))}}))}}})();document.addEventListener("DOMContentLoaded",(()=>{d.init().then((()=>{}))})),d.events()})();