{"version":3,"file":"./backend/admin.certificates.js","mappings":"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","sources":["webpack://learnpress-certificates/./assets/src/js/backend/loadListCertificates.js","webpack://learnpress-certificates/./assets/src/js/utils.js","webpack://learnpress-certificates/webpack/bootstrap","webpack://learnpress-certificates/webpack/runtime/define property getters","webpack://learnpress-certificates/webpack/runtime/hasOwnProperty shorthand","webpack://learnpress-certificates/webpack/runtime/make namespace object","webpack://learnpress-certificates/./assets/src/js/backend/admin.certificates.js"],"sourcesContent":["/**\n * Load list certificates\n *\n * @since 4.0.9\n * @version 1.0.2\n */\n\nimport { listenElementCreated, lpFetchAPI } from '../utils';\n\nconst loadListCertificates = () => {\n\tlet isLoadingMoreCer = 0;\n\n\t// Events\n\tdocument.addEventListener( 'click', ( e ) => {\n\t\tconst target = e.target;\n\t\tif ( target.classList.contains( 'lp-cer-btn-load-more' ) ) {\n\t\t\te.preventDefault();\n\n\t\t\tif ( ! isLoadingMoreCer ) {\n\t\t\t\tisLoadingMoreCer = 1;\n\t\t\t\tloadMoreCertificates( target );\n\t\t\t}\n\t\t}\n\n\t\tif ( target.classList.contains( 'button-assign-certificate' ) ) {\n\t\t\te.preventDefault();\n\t\t\tconst courseID = document.getElementById( 'post_ID' ).value;\n\t\t\tconst themeCertificate = target.closest( '.theme' );\n\t\t\tconst elCertificates = target.closest( '.lp-certificates' );\n\t\t\tconst certificateID = themeCertificate.dataset.id;\n\n\t\t\telCertificates.querySelectorAll( '.theme' ).forEach( ( el ) => {\n\t\t\t\tel.classList.remove( 'active' );\n\t\t\t} );\n\n\t\t\tthemeCertificate.classList.add( 'active', 'updating' );\n\n\t\t\t// Update\n\t\t\tupdateCerOfCourse( courseID, certificateID );\n\t\t}\n\n\t\tif ( target.classList.contains( 'button-remove-certificate' ) ) {\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t\tconst courseID = document.getElementById( 'post_ID' ).value;\n\t\t\tconst themeCertificate = target.closest( '.theme' );\n\t\t\tthemeCertificate.classList.add( 'updating' );\n\t\t\tthemeCertificate.classList.remove( 'active' );\n\n\t\t\t// Update\n\t\t\tupdateCerOfCourse( courseID, 0 );\n\t\t}\n\t} );\n\n\tconst updateCerOfCourse = ( courseId, certId ) => {\n\t\tconst formData = new FormData();\n\t\tformData.append( 'lp-ajax', `update-course-certificate` );\n\t\tformData.append( 'course_id', courseId );\n\t\tformData.append( 'cert_id', certId );\n\n\t\tfetch( '', {\n\t\t\tmethod: 'POST',\n\t\t\tbody: formData,\n\t\t} )\n\t\t\t.then( ( res ) => res.text() )\n\t\t\t.then( ( res ) => {\n\t\t\t\tconst elCertificateBrowser = document.querySelector( '#certificate-browser' );\n\t\t\t\tconst elThemes = elCertificateBrowser.querySelectorAll( '.theme.updating' );\n\t\t\t\telThemes.forEach( ( el ) => {\n\t\t\t\t\tel.classList.remove( 'updating' );\n\t\t\t\t} );\n\t\t\t} )\n\t\t\t.catch( ( error ) => {\n\t\t\t\tconsole.log( error );\n\t\t\t} );\n\t};\n\n\tconst loadMoreCertificates = ( btnLoadMore ) => {\n\t\tconst textBtnLoadMore = btnLoadMore.textContent;\n\t\tconst elTarget = btnLoadMore.closest( '.lp-target' );\n\t\tif ( ! elTarget ) {\n\t\t\treturn;\n\t\t}\n\n\t\tbtnLoadMore.textContent = localize_lp_cer_js.i18n.loading + '...';\n\t\tconst dataSend = JSON.parse( elTarget.dataset.send );\n\t\tdataSend.args.paged = parseInt( dataSend.args.paged ) + 1;\n\t\telTarget.dataset.send = JSON.stringify( dataSend );\n\n\t\tconst url = lpDataAdmin.lp_rest_url + 'lp/v1/load_content_via_ajax/';\n\t\tconst callBack = {\n\t\t\tsuccess: ( response ) => {\n\t\t\t\tconst elAddNewTheme = document.querySelector( '.add-new-theme' );\n\t\t\t\tconst { status, message, data } = response;\n\n\t\t\t\tif ( 'success' === status ) {\n\t\t\t\t\tconst elTmp = document.createElement( 'div' );\n\t\t\t\t\telTmp.innerHTML = data.content;\n\t\t\t\t\tconst elListCertificates = elTmp.querySelector( '.theme' );\n\t\t\t\t\telAddNewTheme.insertAdjacentElement( 'beforebegin', elListCertificates );\n\t\t\t\t\tif ( data.paged === data.total_pages ) {\n\t\t\t\t\t\tbtnLoadMore.remove();\n\t\t\t\t\t}\n\t\t\t\t\tbuildCanvas();\n\t\t\t\t} else if ( 'error' === status ) {\n\t\t\t\t\telTarget.innerHTML = message;\n\t\t\t\t}\n\t\t\t},\n\t\t\terror: ( error ) => {\n\t\t\t\tconsole.log( error );\n\t\t\t},\n\t\t\tcompleted: () => {\n\t\t\t\tisLoadingMoreCer = 0;\n\t\t\t\tbtnLoadMore.textContent = textBtnLoadMore;\n\t\t\t},\n\t\t};\n\n\t\twindow.lpAJAXG.fetchAPI( url, dataSend, callBack );\n\t};\n\n\tconst buildCanvas = () => {\n\t\tconst el_lp_data_config_cer = document.querySelectorAll( '.lp-data-config-cer:not(.loaded)' );\n\t\tel_lp_data_config_cer.forEach( ( el ) => {\n\t\t\tconst data_config_cer = JSON.parse( el.value ) || {};\n\t\t\tconst id_div_parent = '#' + el.closest( 'div' ).getAttribute( 'id' );\n\n\t\t\twindow.LP_Certificate( id_div_parent, data_config_cer );\n\t\t} );\n\t};\n\n\t// Listen el courses load infinite have just created.\n\tlistenElementCreated( ( node ) => {\n\t\tif ( node.classList.contains( 'lp-certificates' ) ) {\n\t\t\tbuildCanvas();\n\t\t}\n\t} );\n};\n\nexport default loadListCertificates;\n","/**\n * Fetch API.\n *\n * @param url\n * @param data\n * @param functions\n * @since 4.2.5.1\n * @version 1.0.1\n */\nconst lpFetchAPI = ( url, data = {}, functions = {} ) => {\n\tif ( 'function' === typeof functions.before ) {\n\t\tfunctions.before();\n\t}\n\n\tfetch( url, { method: 'GET', ...data } )\n\t\t.then( ( response ) => response.json() )\n\t\t.then( ( response ) => {\n\t\t\tif ( 'function' === typeof functions.success ) {\n\t\t\t\tfunctions.success( response );\n\t\t\t}\n\t\t} ).catch( ( err ) => {\n\t\t\tif ( 'function' === typeof functions.error ) {\n\t\t\t\tfunctions.error( err );\n\t\t\t}\n\t\t} )\n\t\t.finally( () => {\n\t\t\tif ( 'function' === typeof functions.completed ) {\n\t\t\t\tfunctions.completed();\n\t\t\t}\n\t\t} );\n};\n\n/**\n * Get current URL without params.\n *\n * @since 4.2.5.1\n */\nconst lpGetCurrentURLNoParam = () => {\n\tlet currentUrl = window.location.href;\n\tconst hasParams = currentUrl.includes( '?' );\n\tif ( hasParams ) {\n\t\tcurrentUrl = currentUrl.split( '?' )[ 0 ];\n\t}\n\n\treturn currentUrl;\n};\n\nconst lpAddQueryArgs = ( endpoint, args ) => {\n\tconst url = new URL( endpoint );\n\n\tObject.keys( args ).forEach( ( arg ) => {\n\t\turl.searchParams.set( arg, args[ arg ] );\n\t} );\n\n\treturn url;\n};\n\n/**\n * Listen element viewed.\n *\n * @param el\n * @param callback\n * @since 4.2.5.8\n */\nconst listenElementViewed = ( el, callback ) => {\n\tconst observerSeeItem = new IntersectionObserver( function( entries ) {\n\t\tfor ( const entry of entries ) {\n\t\t\tif ( entry.isIntersecting ) {\n\t\t\t\tcallback( entry );\n\t\t\t}\n\t\t}\n\t} );\n\n\tobserverSeeItem.observe( el );\n};\n\n/**\n * Listen element created.\n *\n * @param callback\n * @since 4.2.5.8\n */\nconst listenElementCreated = ( callback ) => {\n\tconst observerCreateItem = new MutationObserver( function( mutations ) {\n\t\tmutations.forEach( function( mutation ) {\n\t\t\tif ( mutation.addedNodes ) {\n\t\t\t\tmutation.addedNodes.forEach( function( node ) {\n\t\t\t\t\tif ( node.nodeType === 1 ) {\n\t\t\t\t\t\tcallback( node );\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t}\n\t\t} );\n\t} );\n\n\tobserverCreateItem.observe( document, { childList: true, subtree: true } );\n\t// End.\n};\n\nexport { lpFetchAPI, lpAddQueryArgs, lpGetCurrentURLNoParam, listenElementViewed, listenElementCreated };\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/* eslint-disable no-var */\n/**\n * Plugin LearnPress Certificates.\n *\n * @author ThimPress\n * @package\n * @version 4.0.0\n *\n * Nhamdv -  Compatible with jQuery > 3.0.0\n */\n\nimport loadListCertificates from './loadListCertificates.js';\n\n( function( $ ) {\n\tvar mediaSelector = {\n\t\t__onSelect: null,\n\t\t__multiple: false,\n\t\t__context: null,\n\t\tactiveFrame: false,\n\n\t\tframe( args ) {\n\t\t\targs = $.extend( {}, args || {} );\n\t\t\tconst k = Math.random() * 100;\n\t\t\tif ( ! this._frame ) {\n\t\t\t\tthis._frame = [];\n\t\t\t}\n\t\t\tif ( ! this._frame[ k ] ) {\n\t\t\t\tthis._frame[ k ] = wp.media( {\n\t\t\t\t\ttitle: args.title || 'Select Media',\n\t\t\t\t\tbutton: {\n\t\t\t\t\t\ttext: args.button_text || 'Insert',\n\t\t\t\t\t},\n\t\t\t\t\tmultiple: args.multiple,\n\t\t\t\t} );\n\t\t\t\tthis._frame[ k ].state( 'library' ).on( 'select', this.select );\n\t\t\t}\n\t\t\treturn this._frame[ k ];\n\t\t},\n\n\t\tselect() {\n\t\t\tif ( typeof mediaSelector.__onSelect === 'function' ) {\n\t\t\t\tlet source = this.get( 'selection' );\n\n\t\t\t\tif ( ! mediaSelector.__multiple ) {\n\t\t\t\t\tsource = source.single().toJSON();\n\t\t\t\t} else {\n\t\t\t\t\tsource = source.toJSON();\n\t\t\t\t}\n\t\t\t\tmediaSelector.__onSelect.call( mediaSelector._frame, source, mediaSelector.__context );\n\t\t\t\tmediaSelector.__onSelect = null;\n\t\t\t\tmediaSelector.__context = null;\n\t\t\t}\n\t\t},\n\t\topen( args ) {\n\t\t\targs = $.extend( {\n\t\t\t\tmultiple: false,\n\t\t\t\tcontext: null,\n\t\t\t\tonSelect() {\n\t\t\t\t},\n\t\t\t}, args || {} );\n\t\t\tif ( typeof args.onSelect === 'function' ) {\n\t\t\t\tmediaSelector.__onSelect = args.onSelect;\n\t\t\t\tmediaSelector.__multiple = args.multiple;\n\t\t\t\tmediaSelector.__context = args.context;\n\t\t\t\tconst f = mediaSelector.frame( args );\n\t\t\t\tf.open();\n\t\t\t}\n\t\t},\n\t};\n\n\t$( document ).ready( function() {\n\t\tvar _ = {\n\t\t\tnow: Date.now || function() {\n\t\t\t\treturn new Date().getTime();\n\t\t\t},\n\t\t\tdebounce( func, wait, immediate ) {\n\t\t\t\tlet timeout, args, context, timestamp, result;\n\n\t\t\t\tvar later = function() {\n\t\t\t\t\tconst last = _.now() - timestamp;\n\n\t\t\t\t\tif ( last < wait && last >= 0 ) {\n\t\t\t\t\t\ttimeout = setTimeout( later, wait - last );\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttimeout = null;\n\t\t\t\t\t\tif ( ! immediate ) {\n\t\t\t\t\t\t\tresult = func.apply( context, args );\n\t\t\t\t\t\t\tif ( ! timeout ) {\n\t\t\t\t\t\t\t\tcontext = args = null;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\treturn function() {\n\t\t\t\t\tcontext = this;\n\t\t\t\t\targs = arguments;\n\t\t\t\t\ttimestamp = _.now();\n\t\t\t\t\tconst callNow = immediate && ! timeout;\n\t\t\t\t\tif ( ! timeout ) {\n\t\t\t\t\t\ttimeout = setTimeout( later, wait );\n\t\t\t\t\t}\n\t\t\t\t\tif ( callNow ) {\n\t\t\t\t\t\tresult = func.apply( context, args );\n\t\t\t\t\t\tcontext = args = null;\n\t\t\t\t\t}\n\t\t\t\t\treturn result;\n\t\t\t\t};\n\t\t\t},\n\t\t};\n\n\t\t// Vue js\n\t\tif ( typeof lpCertificatesSettings === 'undefined' ) {\n\t\t\tconsole.log( 'lpCertificatesSettings is not defined!' );\n\t\t\tconsole.log( 'Only load when edit certificate' );\n\t\t\treturn;\n\t\t}\n\n\t\twindow.$LP_Certificates = new Vue( {\n\t\t\tel: '#learn-press-certificates',\n\t\t\ttemplate: '#tmpl-certificates',\n\t\t\tdata: $.extend( {\n\t\t\t\tdragover: false,\n\t\t\t\tviewport: {\n\t\t\t\t\twidth: 0,\n\t\t\t\t\theight: 0,\n\t\t\t\t\ttemplateWidth: 0,\n\t\t\t\t\ttemplateHeight: 0,\n\t\t\t\t\tratio: 1,\n\t\t\t\t},\n\t\t\t\t$view: false,\n\t\t\t\t$layerOptions: null,\n\t\t\t\tloaded: false,\n\t\t\t\ti18n: {},\n\t\t\t\ttemplate: 'xxx',\n\t\t\t}, lpCertificatesSettings ),\n\n\t\t\tcomputed: {\n\t\t\t\tgetMaxWidth() {\n\t\t\t\t\treturn Math.random();\n\t\t\t\t},\n\t\t\t},\n\t\t\tcreated() {\n\t\t\t\tconst that = this;\n\t\t\t\tsetTimeout( function() {\n\t\t\t\t\tthat.init();\n\t\t\t\t}, 300 );\n\t\t\t},\n\n\t\t\tmethods: {\n\t\t\t\tinit() {\n\t\t\t\t\tconst that = this;\n\t\t\t\t\tthis.$img = this.$( '.cert-template' );\n\t\t\t\t\tthis.$img_preload = document.getElementById( 'cert-template-preload' );\n\t\t\t\t\tthis.initCanvas();\n\t\t\t\t\tthis.initDragAndDrop();\n\t\t\t\t\tif ( $( '#cert-template-preload' ).length ) {\n\t\t\t\t\t\tthis.viewport = {\n\t\t\t\t\t\t\twidth: this.$img_preload.width,\n\t\t\t\t\t\t\theight: this.$img_preload.height,\n\t\t\t\t\t\t\ttemplateWidth: this.$img_preload.naturalWidth,\n\t\t\t\t\t\t\ttemplateHeight: this.$img_preload.naturalHeight,\n\t\t\t\t\t\t\tratio: this.$img_preload.width / this.$img_preload.naturalWidth,\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthis.updateView();\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.$img.on( 'load', function() {\n\t\t\t\t\t\tthat.viewport = {\n\t\t\t\t\t\t\twidth: this.width,\n\t\t\t\t\t\t\theight: this.height,\n\t\t\t\t\t\t\ttemplateWidth: this.naturalWidth,\n\t\t\t\t\t\t\ttemplateHeight: this.naturalHeight,\n\t\t\t\t\t\t\tratio: this.width / this.naturalWidth,\n\t\t\t\t\t\t};\n\t\t\t\t\t\tconsole.log( that.viewport );\n\t\t\t\t\t\tthat.loaded && that.ajaxUpdateTemplate();\n\t\t\t\t\t\tthat.updateView();\n\t\t\t\t\t} ).trigger( 'load' );\n\n\t\t\t\t\tthis.$layerOptions = $( '.cert-layer-options' );\n\n\t\t\t\t\t$( document ).on( 'certificate/change-layer-option', _.debounce( function( e, data ) {\n\t\t\t\t\t\tconst options = {};\n\t\t\t\t\t\toptions[ data.name ] = data.value;\n\t\t\t\t\t\tthat.updateActiveLayer( options );\n\t\t\t\t\t}, 100 ) );\n\n\t\t\t\t\t$( window ).on( 'resize.certificate-update-view', function() {\n\t\t\t\t\t\tlet timer = $( this ).data( 'timer' );\n\t\t\t\t\t\ttimer && clearTimeout( timer );\n\t\t\t\t\t\ttimer = setTimeout( function() {\n\t\t\t\t\t\t\tthat.updateView();\n\t\t\t\t\t\t}, 300 );\n\t\t\t\t\t} );\n\n\t\t\t\t\t$( document ).on( 'click', '.layer-center', function() {\n\t\t\t\t\t\tconst type = $( this ).data( 'center' );\n\t\t\t\t\t\tswitch ( type ) {\n\t\t\t\t\t\tcase 'center-h':\n\t\t\t\t\t\t\tthat.centerH();\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'center-v':\n\t\t\t\t\t\t\tthat.centerV();\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'center':\n\t\t\t\t\t\t\tthat.center();\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\n\t\t\t\t\t$( document ).on( 'click', '.cert-layers .layer', function( e ) {\n\t\t\t\t\t\tconst $layer = that.findLayer( $( this ).data( 'layer' ) );\n\t\t\t\t\t\t$layer && that.$canvas.setActiveObject( $layer );\n\t\t\t\t\t\tif ( $( e.target ).is( 'a' ) ) {\n\t\t\t\t\t\t\tthat.deleteLayer();\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\n\t\t\t\t\tthis.loaded = true;\n\t\t\t\t},\n\t\t\t\tfindLayer( name ) {\n\t\t\t\t\tconst $layers = this.$canvas.getObjects();\n\t\t\t\t\tfor ( const i in $layers ) {\n\t\t\t\t\t\tif ( $layers[ i ].name === name ) {\n\t\t\t\t\t\t\treturn $layers[ i ];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t},\n\t\t\t\taddCustomPreview() {\n\n\t\t\t\t},\n\t\t\t\tcenterV( $layer ) {\n\t\t\t\t\tif ( ! $layer ) {\n\t\t\t\t\t\t$layer = this.getActiveLayer();\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( ! $layer ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst position = {\n\t\t\t\t\t\ttop: ( this.$canvas.height / this.viewport.ratio - $layer.height * Math.abs( $layer.scaleY ) ) / 2,\n\t\t\t\t\t};\n\n\t\t\t\t\tif ( $layer.originY === 'center' ) {\n\t\t\t\t\t\tposition.top += $layer.height / 2;\n\t\t\t\t\t}\n\n\t\t\t\t\t$layer.set( position );\n\t\t\t\t\t$layer.setCoords();\n\t\t\t\t\tthis.updateView();\n\t\t\t\t\tthis.updateActiveLayer( position );\n\t\t\t\t},\n\t\t\t\tcenterH( $layer ) {\n\t\t\t\t\tif ( ! $layer ) {\n\t\t\t\t\t\t$layer = this.getActiveLayer();\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( ! $layer ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst position = {\n\t\t\t\t\t\tleft: ( this.$canvas.width / this.viewport.ratio - $layer.width * Math.abs( $layer.scaleX ) ) / 2,\n\t\t\t\t\t};\n\n\t\t\t\t\tif ( $layer.originX === 'center' ) {\n\t\t\t\t\t\tposition.left += $layer.width / 2;\n\t\t\t\t\t}\n\n\t\t\t\t\t$layer.set( position );\n\t\t\t\t\t$layer.setCoords();\n\t\t\t\t\tthis.updateView();\n\t\t\t\t\tthis.updateActiveLayer( position );\n\t\t\t\t},\n\t\t\t\tcenter( $layer ) {\n\t\t\t\t\tthis.centerV( $layer );\n\t\t\t\t\tthis.centerH( $layer );\n\t\t\t\t},\n\t\t\t\tdeleteLayer() {\n\t\t\t\t\tif ( ! confirm( this.i18n.confirm_remove_layer ) ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst $layer = this.getActiveLayer(),\n\t\t\t\t\t\tname = $layer.get( 'name' );\n\t\t\t\t\tif ( $layer ) {\n\t\t\t\t\t\tthis.$canvas.remove( $layer );\n\t\t\t\t\t\tVue.http.post( '', {\n\t\t\t\t\t\t\tlayer: name,\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\temulateJSON: true,\n\t\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\t\t'lp-ajax': 'cert-remove-layer',\n\t\t\t\t\t\t\t\tid: this.id,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t} ).then( function() {\n\t\t\t\t\t\t\t$( '.cert-layers' ).children().filter( '[data-layer=\"' + name + '\"]' ).remove();\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tgetActiveLayer() {\n\t\t\t\t\treturn this.$canvas.getActiveObject();\n\t\t\t\t},\n\t\t\t\tgetMaxWidth() {\n\t\t\t\t\tconst w = this.$().width();\n\t\t\t\t\treturn w - 60;\n\t\t\t\t},\n\t\t\t\tupdateActiveLayer( options, $layer ) {\n\t\t\t\t\t$layer = $layer ? $layer : this.getActiveLayer();\n\t\t\t\t\tif ( ! $layer ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tfor ( const prop in options ) {\n\t\t\t\t\t\tthis.setLayerProp( $layer, prop, options[ prop ] );\n\t\t\t\t\t}\n\t\t\t\t\tthis.$canvas.renderAll();\n\t\t\t\t\tthis.ajaxUpdateLayer( $layer );\n\t\t\t\t},\n\t\t\t\tcalculate() {\n\t\t\t\t\tthis.viewport = $.extend( this.viewport, {\n\t\t\t\t\t\twidth: this.$img.width(),\n\t\t\t\t\t\theight: this.$img.height(),\n\t\t\t\t\t\tratio: this.$img.width() / this.viewport.templateWidth,\n\t\t\t\t\t} );\n\t\t\t\t},\n\t\t\t\tupdateView() {\n\t\t\t\t\tconst maxWidth = this.getMaxWidth();\n\t\t\t\t\tthis.calculate();\n\t\t\t\t\tif ( this.viewport.templateWidth < maxWidth && this.template ) {\n\t\t\t\t\t\tthis.$( '#cert-design-view' ).css( 'width', this.viewport.width + 60 ).addClass( 'small' );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.$( '#cert-design-view' ).css( 'width', '' ).removeClass( 'small' );\n\t\t\t\t\t}\n\t\t\t\t\tthis.$canvas.setHeight( this.viewport.height );\n\t\t\t\t\tthis.$canvas.setWidth( this.viewport.width );\n\t\t\t\t\tthis.$canvas.setZoom( this.viewport.ratio );\n\t\t\t\t\tthis.$canvas.calcOffset();\n\t\t\t\t\tthis.$canvas.renderAll();\n\t\t\t\t},\n\t\t\t\t$( selector ) {\n\t\t\t\t\tconst $el = $( this.$el );\n\t\t\t\t\treturn selector ? $el.find( selector ) : $el;\n\t\t\t\t},\n\t\t\t\tgetLayerOptions( $layer ) {\n\t\t\t\t\treturn $layer ? $layer.toObject( this.getExtendedFields() ) : {};\n\t\t\t\t},\n\t\t\t\tgetExtendedFields() {\n\t\t\t\t\tlet _fields = [ 'name', 'fieldType', 'display', 'customText', 'format', 'variable', 'formatDate', 'qr_size', 'fontFile' ],\n\t\t\t\t\t\tfields = $( document ).triggerHandler( 'learn_press_certificates_extended_fields', [ _fields ] );\n\t\t\t\t\tif ( typeof fields === 'undefined' ) {\n\t\t\t\t\t\tfields = _fields;\n\t\t\t\t\t}\n\t\t\t\t\treturn fields;\n\t\t\t\t},\n\t\t\t\tshowControls( e ) {\n\t\t\t\t},\n\t\t\t\tshowLines() {\n\t\t\t\t\tconst $el = this.getActiveLayer();\n\t\t\t\t\tif ( ! $el ) {\n\t\t\t\t\t\tthis.hideLines();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tthis.$( '#cert-design-view' ).addClass( 'dragover' );\n\t\t\t\t\tthis.$( '#cert-design-line-horizontal' ).css( 'top', $el.top * this.viewport.ratio );\n\t\t\t\t\tthis.$( '#cert-design-line-vertical' ).css( 'left', $el.left * this.viewport.ratio - 1 );\n\t\t\t\t},\n\t\t\t\thideLines() {\n\t\t\t\t\tthis.$( '#cert-design-view' ).removeClass( 'dragover' );\n\t\t\t\t},\n\t\t\t\ttoFixedX( num ) {\n\t\t\t\t\treturn Math.ceil( num * 10 ) / 10;\n\t\t\t\t},\n\t\t\t\thideControls() {\n\t\t\t\t},\n\n\t\t\t\tgetLayers() {\n\t\t\t\t\tconst layers = {},\n\t\t\t\t\t\t$objects = this.$canvas.getObjects();\n\n\t\t\t\t\tfor ( const i in $objects ) {\n\t\t\t\t\t\tlayers[ $objects[ i ].name ] = this.getLayerOptions( $objects[ i ] );\n\t\t\t\t\t}\n\n\t\t\t\t\treturn layers;\n\t\t\t\t},\n\n\t\t\t\tajaxUpdateLayers: _.debounce( function() {\n\t\t\t\t\tconst that = this;\n\n\t\t\t\t\treturn Vue.http.post( '', {\n\t\t\t\t\t\tlayers: this.getLayers(),\n\t\t\t\t\t}, {\n\t\t\t\t\t\temulateJSON: true,\n\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\t'lp-ajax': 'cert-update-layers',\n\t\t\t\t\t\t\tid: this.id,\n\t\t\t\t\t\t},\n\t\t\t\t\t} );\n\t\t\t\t}, 300 ),\n\n\t\t\t\tajaxUpdateLayer: _.debounce( function( layer, loadSettings ) {\n\t\t\t\t\tlayer = $.isPlainObject( layer ) ? layer : this.getLayerOptions( layer );\n\n\t\t\t\t\tconst that = this,\n\t\t\t\t\t\thash = JSON.stringify( layer ).md5();\n\t\t\t\t\tif ( hash === layer.hash ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn Vue.http.post( '', {\n\t\t\t\t\t\tlayer,\n\t\t\t\t\t\t'load-settings': loadSettings ? 'yes' : 'no',\n\t\t\t\t\t}, {\n\t\t\t\t\t\temulateJSON: true,\n\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\t'lp-ajax': 'cert-update-layer',\n\t\t\t\t\t\t\tid: this.id,\n\t\t\t\t\t\t},\n\t\t\t\t\t} ).then( function( response ) {\n\t\t\t\t\t\tconst $layerOptions = $( response.body );\n\t\t\t\t\t\tif ( $layerOptions.hasClass( 'cert-layer-options' ) ) {\n\t\t\t\t\t\t\tthat.$layerOptions = $layerOptions;\n\t\t\t\t\t\t\t$( '#certificates-options' ).removeClass( 'loading' ).find( '.inside' ).html( that.$layerOptions );\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t}, 300 ),\n\n\t\t\t\tajaxUpdateTemplate: _.debounce( function() {\n\t\t\t\t\treturn Vue.http.post( '', {\n\t\t\t\t\t\ttemplate: this.template,\n\t\t\t\t\t}, {\n\t\t\t\t\t\temulateJSON: true,\n\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\t'lp-ajax': 'cert-update-template',\n\t\t\t\t\t\t\tid: this.id,\n\t\t\t\t\t\t},\n\t\t\t\t\t} );\n\t\t\t\t}, 300 ),\n\n\t\t\t\tajaxLoadLayer: _.debounce( function( $layer ) {\n\t\t\t\t\tconst that = this;\n\t\t\t\t\t$( '#certificates-options' ).show().addClass( 'loading' );\n\t\t\t\t\treturn Vue.http.post( '', {\n\t\t\t\t\t\tlayer: $layer.get( 'name' ),\n\t\t\t\t\t}, {\n\t\t\t\t\t\temulateJSON: true,\n\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\t'lp-ajax': 'cert-load-layer',\n\t\t\t\t\t\t\tid: this.id,\n\t\t\t\t\t\t},\n\t\t\t\t\t} ).then( function( response ) {\n\t\t\t\t\t\tthat.$layerOptions = $( response.body );\n\t\t\t\t\t\t$( '#certificates-options' ).removeClass( 'loading' ).find( '.inside' ).html( that.$layerOptions );\n\t\t\t\t\t} );\n\t\t\t\t}, 300 ),\n\n\t\t\t\taddLayerList( $layer ) {\n\t\t\t\t\tconst $l = $( '<div class=\"layer\" data-layer=\"' + $layer.name + '\">' + 'Layer #' + $layer.text + '<a href=\"\"></a></div>' );\n\t\t\t\t\t$( '.cert-layers' ).prepend( $l );\n\t\t\t\t},\n\n\t\t\t\taddLayer( $layer, args ) {\n\t\t\t\t\targs = $.extend( {\n\t\t\t\t\t\tsetActive: true,\n\t\t\t\t\t}, args || {} );\n\n\t\t\t\t\tif ( $.isPlainObject( $layer ) ) {\n\t\t\t\t\t\t$layer = this.createLayer( $layer );\n\t\t\t\t\t}\n\t\t\t\t\tif ( $layer ) {\n\t\t\t\t\t\tthis.loaded && this.ajaxUpdateLayer( $layer, true );\n\t\t\t\t\t\tthis.$canvas.add( $layer );\n\t\t\t\t\t\tthis.addLayerList( $layer );\n\t\t\t\t\t\tif ( args.setActive ) {\n\t\t\t\t\t\t\tthis.$canvas.setActiveObject( $layer );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.$canvas.renderAll();\n\t\t\t\t\t}\n\t\t\t\t\treturn $layer;\n\t\t\t\t},\n\n\t\t\t\tcreateLayer( args ) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tvar defaults = $.extend( {\n\t\t\t\t\t\t\t\tfontSize: 24,\n\t\t\t\t\t\t\t\tleft: 0,\n\t\t\t\t\t\t\t\ttop: 0,\n\t\t\t\t\t\t\t\tlineHeight: 1,\n\t\t\t\t\t\t\t\toriginX: 'center',\n\t\t\t\t\t\t\t\toriginY: 'center',\n\t\t\t\t\t\t\t\tfontFamily: 'Helvetica',\n\t\t\t\t\t\t\t\tname: this.uniqueId(),\n\t\t\t\t\t\t\t\tfieldType: 'custom',\n\t\t\t\t\t\t\t\tvariable: '',\n\t\t\t\t\t\t\t}, args ),\n\t\t\t\t\t\t\ttext = args.text || '',\n\t\t\t\t\t\t\t$object = new fabric.Text( text, defaults ),\n\t\t\t\t\t\t\tthat = this;\n\n\t\t\t\t\t\tif ( args.fieldType == 'verified-link' ) {\n\t\t\t\t\t\t\tdefaults.qr_size = 40;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst is_url = /^(https?|s?ftp):\\/\\//i.test( args.text );\n\t\t\t\t\t\tif ( args.fieldType == 'verified-link' && args.qr_size > 0 && is_url ) {\n\t\t\t\t\t\t\tconst qr_code = new Image();\n\t\t\t\t\t\t\tdefaults.type = 'image';\n\t\t\t\t\t\t\tdefaults.height = defaults.qr_size;\n\t\t\t\t\t\t\tdefaults.width = defaults.qr_size;\n\t\t\t\t\t\t\tqr_code.crossOrigin = 'Anonymous';\n\t\t\t\t\t\t\tqr_code.src = args.text;\n\t\t\t\t\t\t\t$object = new fabric.Image( qr_code, defaults );\n\t\t\t\t\t\t}\n\t\t\t\t\t\t$object.set( {\n\t\t\t\t\t\t\tborderColor: '#AAA',\n\t\t\t\t\t\t\tcornerColor: '#666',\n\t\t\t\t\t\t\tcornerSize: 7,\n\t\t\t\t\t\t\ttransparentCorners: true,\n\t\t\t\t\t\t\tpadding: 0,\n\t\t\t\t\t\t} );\n\t\t\t\t\t\t$.each( defaults, function( k, v ) {\n\t\t\t\t\t\t\tthat.setLayerProp( $object, k, v );\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t\tconst $_object = $( document ).triggerHandler( 'learn_press_certificate_layer_obj', [ $object, args ] );\n\t\t\t\t\t\tif ( typeof $_object === 'object' ) {\n\t\t\t\t\t\t\t$object = $_object;\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch ( e ) {\n\t\t\t\t\t\tconsole.log( e );\n\t\t\t\t\t}\n\t\t\t\t\treturn $object;\n\t\t\t\t},\n\n\t\t\t\t// Update options of a layer to settings panel\n\t\t\t\tupdateLayerOptions: _.debounce( function( $layer ) {\n\t\t\t\t\tconst that = this,\n\t\t\t\t\t\toptions = this.getLayerOptions( $layer ? $layer : this.getActiveLayer() ),\n\t\t\t\t\t\t$opt = this.$layerOptions.find( ':input' );\n\n\t\t\t\t\t$.each( options, function( k, v ) {\n\t\t\t\t\t\tswitch ( k ) {\n\t\t\t\t\t\tcase 'fontFamily':\n\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'fontStyle':\n\t\t\t\t\t\tcase 'fontWeight':\n\t\t\t\t\t\t\tif ( v === 'normal' ) {\n\t\t\t\t\t\t\t\tv = '';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'originY':\n\t\t\t\t\t\t\tif ( v === 'middle' ) {\n\t\t\t\t\t\t\t\tv = 'center';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'top':\n\t\t\t\t\t\tcase 'left':\n\t\t\t\t\t\t\tv = parseInt( v );\n\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'angle':\n\t\t\t\t\t\tcase 'scaleX':\n\t\t\t\t\t\tcase 'scaleY':\n\t\t\t\t\t\t\tv = that.toFixedX( v );\n\t\t\t\t\t\t}\n\t\t\t\t\t\t$opt.filter( '[name=\"' + k + '\"]' ).val( v );\n\t\t\t\t\t} );\n\n\t\t\t\t\t$( '#certificates-options' ).show();\n\t\t\t\t}, 300 ),\n\n\t\t\t\t// Set property of a layer\n\t\t\t\tsetLayerProp( $layer, prop, value ) {\n\t\t\t\t\tconst options = {};\n\t\t\t\t\tif ( value === undefined ) {\n\t\t\t\t\t\tvalue = '';\n\t\t\t\t\t}\n\t\t\t\t\tswitch ( prop ) {\n\t\t\t\t\tcase 'color':\n\t\t\t\t\t\toptions.fill = value;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'scaleX':\n\t\t\t\t\tcase 'scaleY':\n\t\t\t\t\t\tif ( isNaN( value ) ) {\n\t\t\t\t\t\t\tvalue = 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ( value < 0 ) {\n\t\t\t\t\t\t\tif ( prop === 'scaleX' ) {\n\t\t\t\t\t\t\t\t$layer.flipX = true;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t$layer.flipY = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if ( prop === 'scaleX' ) {\n\t\t\t\t\t\t\t$layer.flipX = false;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$layer.flipY = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\toptions[ prop ] = this.toFixedX( Math.abs( value ) );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'top':\n\t\t\t\t\tcase 'left':\n\t\t\t\t\t\tif ( isNaN( value ) ) {\n\t\t\t\t\t\t\tvalue = 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\toptions[ prop ] = parseInt( value );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'angle':\n\t\t\t\t\t\toptions[ prop ] = this.toFixedX( value );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'fontFamily':\n\t\t\t\t\t\tvalue = '' + value;\n\t\t\t\t\t\t$layer.set( 'fontFamily', value.replace( /\\+/, ' ' ) );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\toptions[ prop ] = value;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( options.flipX ) {\n\t\t\t\t\t\toptions.scaleX = -this.toFixedX( options.scaleX );\n\t\t\t\t\t}\n\t\t\t\t\tif ( options.flipY ) {\n\t\t\t\t\t\toptions.scaleY = -this.toFixedX( options.scaleY );\n\t\t\t\t\t}\n\n\t\t\t\t\t$.each( options, function( k, v ) {\n\t\t\t\t\t\t$layer.set( k, v );\n\t\t\t\t\t} );\n\t\t\t\t\t$layer.setCoords();\n\t\t\t\t},\n\t\t\t\tonObjectSelected( e ) {\n\t\t\t\t\t//this.$canvas.bringToFront(e.target);\n\t\t\t\t\tconst layerOptions = this.getLayerOptions( e.target );\n\t\t\t\t\tfor ( const i in layerOptions ) {\n\t\t\t\t\t\tthis.setLayerProp( e.target, i, layerOptions[ i ] );\n\t\t\t\t\t}\n\t\t\t\t\t$( '.cert-layers' ).children().removeClass( 'active' ).filter( '[data-layer=\"' + e.target.name + '\"]' ).addClass( 'active' );\n\t\t\t\t\tthis.ajaxLoadLayer( e.target );\n\t\t\t\t},\n\t\t\t\tonObjectMoving( event ) {\n\t\t\t\t\tthis.updateLayerOptions();\n\t\t\t\t\tthis.ajaxUpdateLayer( event.target );\n\t\t\t\t\tthis.showLines();\n\t\t\t\t},\n\t\t\t\tonObjectRotating( event ) {\n\t\t\t\t\tthis.updateLayerOptions();\n\t\t\t\t\tthis.ajaxUpdateLayer( event.target );\n\t\t\t\t\tconst $object = this.$canvas.getActiveObject(),\n\t\t\t\t\t\tangle = this.toFixedX( $object.angle );\n\t\t\t\t\tthis.setPropSlider( 'angle', angle );\n\t\t\t\t\tthis.hideLines();\n\t\t\t\t},\n\t\t\t\tonObjectMouseup() {\n\t\t\t\t\tthis.hideLines();\n\t\t\t\t},\n\t\t\t\tonObjectMousedown() {\n\t\t\t\t\tthis.showLines();\n\t\t\t\t},\n\t\t\t\tonBeforeSelectionCleared( e ) {\n\t\t\t\t\t$( '#certificates-options' ).hide();\n\t\t\t\t\t$( '.cert-layers' ).children().removeClass( 'active' );\n\t\t\t\t\tthis.hideLines();\n\t\t\t\t},\n\t\t\t\tonObjectModified( e ) {\n\t\t\t\t\tthis.showControls( e );\n\t\t\t\t},\n\t\t\t\tlimitObjectScale() {\n\t\t\t\t\tlet $object = this.$canvas.getActiveObject(),\n\t\t\t\t\t\tscaleX = this.toFixedX( $object.scaleX ),\n\t\t\t\t\t\tscaleY = this.toFixedX( $object.scaleY );\n\t\t\t\t\tif ( $object.flipX ) {\n\t\t\t\t\t\tscaleX = -scaleX;\n\t\t\t\t\t}\n\t\t\t\t\tif ( $object.flipY ) {\n\t\t\t\t\t\tscaleY = -scaleY;\n\t\t\t\t\t}\n\t\t\t\t\tthis.ajaxUpdateLayer( $object );\n\t\t\t\t\tthis.setPropSlider( 'scaleX', scaleX );\n\t\t\t\t\tthis.setPropSlider( 'scaleY', scaleY );\n\t\t\t\t},\n\t\t\t\tsetPropSlider( name, value ) {\n\t\t\t\t\tthis.$layerOptions\n\t\t\t\t\t\t.find( 'input[name=\"' + name + '\"]' )\n\t\t\t\t\t\t.val( value )\n\t\t\t\t\t\t.siblings( '.cert-option-slider' )\n\t\t\t\t\t\t.slider( 'option', 'value', value );\n\t\t\t\t},\n\t\t\t\tinitCanvas() {\n\t\t\t\t\tif ( ! this.$canvas ) {\n\t\t\t\t\t\tconst that = this,\n\t\t\t\t\t\t\t$canvas = this.$( 'canvas' );\n\n\t\t\t\t\t\tthis.$canvas = new fabric.Canvas( $canvas.get( 0 ), this.layers );\n\t\t\t\t\t\tthis.$canvas.on( {\n\t\t\t\t\t\t\t'object:selected': this.onObjectSelected,\n\t\t\t\t\t\t\t'object:moving': this.onObjectMoving,\n\t\t\t\t\t\t\t'object:rotating': this.onObjectRotating,\n\t\t\t\t\t\t\t'mouse:up': this.onObjectMouseup,\n\t\t\t\t\t\t\t'mouse:down': this.onObjectMousedown,\n\t\t\t\t\t\t\t'before:selection:cleared': this.onBeforeSelectionCleared,\n\t\t\t\t\t\t\t'object:modified': this.onObjectModified,\n\t\t\t\t\t\t} ).observe( 'object:scaling', this.limitObjectScale );\n\t\t\t\t\t\tthis.$canvas.selection = false;\n\t\t\t\t\t\t$.each( this.layers, function( i, layer ) {\n\t\t\t\t\t\t\tif ( ! layer.type ) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthat.addLayer( layer, { setActive: false } );\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t_.debounce( this.updateView, 300 )();\n\t\t\t\t\t\tconsole.log( 'initCanvas' );\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tinitDragAndDrop() {\n\t\t\t\t\tconst that = this;\n\t\t\t\t\tthis.$view = $( this.$el ).find( '#cert-design-view' );\n\n\t\t\t\t\t$( '.cert-fields li' ).draggable( {\n\t\t\t\t\t\thelper: 'clone',\n\t\t\t\t\t\tdrag( e, ui ) {\n\t\t\t\t\t\t\tconst targetOffset = that.$view.offset();\n\t\t\t\t\t\t\tthat.dragover = {\n\t\t\t\t\t\t\t\tleft: ui.offset.left - targetOffset.left + 26,\n\t\t\t\t\t\t\t\ttop: ui.offset.top - targetOffset.top + 13,\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\tif ( that.dragover.left < 0 || that.dragover.top < 0 ) {\n\t\t\t\t\t\t\t\tthat.dragover = false;\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tthat.updateLines();\n\t\t\t\t\t\t},\n\t\t\t\t\t} );\n\t\t\t\t\t$( '#cert-design-editor' ).droppable( {\n\t\t\t\t\t\tover( e, ui ) {\n\t\t\t\t\t\t\tthat.dragover = true;\n\t\t\t\t\t\t\tthat.dragover = ui.position;\n\t\t\t\t\t\t\tthat.updateLines();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tout() {\n\t\t\t\t\t\t\tthat.dragover = false;\n\t\t\t\t\t\t},\n\t\t\t\t\t\tdrop( e, ui ) {\n\t\t\t\t\t\t\tthat.dragover = false;\n\t\t\t\t\t\t\tconst parentOffset = that.$view.find( '.canvas-container' ).offset();\n\t\t\t\t\t\t\tconst left = ( ui.offset.left - parentOffset.left + ui.draggable.outerWidth() / 2 ) / that.viewport.ratio,\n\t\t\t\t\t\t\t\ttop = ( ui.offset.top - parentOffset.top + ui.draggable.outerHeight() / 2 ) / that.viewport.ratio;\n\t\t\t\t\t\t\tthat.addLayerByDrop( {\n\t\t\t\t\t\t\t\ttop,\n\t\t\t\t\t\t\t\tleft,\n\t\t\t\t\t\t\t\ttext: ui.draggable.text().trim(),\n\t\t\t\t\t\t\t\tfieldType: ui.draggable.data( 'type' ),\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t},\n\t\t\t\t\t} );\n\n\t\t\t\t\t$( '.cert-layers' ).sortable( {\n\t\t\t\t\t\taxis: 'y',\n\t\t\t\t\t\tstart( e, ui ) {\n\t\t\t\t\t\t\tconst $children = $( this ).children();\n\t\t\t\t\t\t\tui.item.data( 'position', $children.index( ui.item ) );\n\t\t\t\t\t\t},\n\t\t\t\t\t\tupdate( e, ui ) {\n\t\t\t\t\t\t\tconst $obj = that.$canvas.getActiveObject();\n\n\t\t\t\t\t\t\tif ( ! $obj ) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tlet $children = $( this ).children(),\n\t\t\t\t\t\t\t\toldPosition = ui.item.data( 'position' ),\n\t\t\t\t\t\t\t\tnewPosition = $children.index( ui.item ),\n\t\t\t\t\t\t\t\ti = 0;\n\n\t\t\t\t\t\t\tif ( newPosition > oldPosition ) {\n\t\t\t\t\t\t\t\tfor ( i = 0; i < newPosition - oldPosition; i++ ) {\n\t\t\t\t\t\t\t\t\t$obj.sendBackwards();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tfor ( i = 0; i < oldPosition - newPosition; i++ ) {\n\t\t\t\t\t\t\t\t\t$obj.bringForward();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tthat.ajaxUpdateLayers();\n\t\t\t\t\t\t},\n\t\t\t\t\t} );\n\t\t\t\t},\n\n\t\t\t\tupdateRulers() {\n\t\t\t\t\tif ( this.dragover ) {\n\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tupdateLines() {\n\t\t\t\t\tif ( this.dragover ) {\n\t\t\t\t\t\t$( this.$el )\n\t\t\t\t\t\t\t.find( '.cert-design-line' )\n\t\t\t\t\t\t\t.filter( '.horizontal' ).css( 'top', this.dragover.top ).end()\n\t\t\t\t\t\t\t.filter( '.vertical' ).css( 'left', this.dragover.left );\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tuniqueId() {\n\t\t\t\t\tfunction s4() {\n\t\t\t\t\t\treturn Math.floor( ( 1 + Math.random() ) * 0x10000 )\n\t\t\t\t\t\t\t.toString( 16 )\n\t\t\t\t\t\t\t.substring( 1 );\n\t\t\t\t\t}\n\n\t\t\t\t\treturn s4() + s4() + s4() + s4();\n\t\t\t\t},\n\t\t\t\tselectTemplate() {\n\t\t\t\t\tmediaSelector.open( {\n\t\t\t\t\t\tcontext: this,\n\t\t\t\t\t\tonSelect( source, that ) {\n\t\t\t\t\t\t\tif ( source.sizes ) {\n\t\t\t\t\t\t\t\tthat.template = source.sizes.full.url;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthat.template = source.url;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tthat.updateView();\n\t\t\t\t\t\t},\n\t\t\t\t\t} );\n\t\t\t\t},\n\t\t\t\tsetPreview() {\n\t\t\t\t\talert( 0 );\n\t\t\t\t},\n\t\t\t\taddLayerByDrop( args ) {\n\t\t\t\t\tconst $layer = this.createLayer( args );\n\n\t\t\t\t\tif ( $layer ) {\n\t\t\t\t\t\tthis.addLayer( $layer );\n\t\t\t\t\t\tthis.$canvas.calcOffset();\n\t\t\t\t\t\tthis.$canvas.renderAll();\n\t\t\t\t\t}\n\t\t\t\t\treturn $layer;\n\t\t\t\t},\n\t\t\t},\n\t\t} );\n\t} );\n}( jQuery ) );\n\nloadListCertificates();\n"],"names":["listenElementCreated","lpFetchAPI","loadListCertificates","isLoadingMoreCer","document","addEventListener","e","target","classList","contains","preventDefault","loadMoreCertificates","courseID","getElementById","value","themeCertificate","closest","elCertificates","certificateID","dataset","id","querySelectorAll","forEach","el","remove","add","updateCerOfCourse","stopPropagation","courseId","certId","formData","FormData","append","fetch","method","body","then","res","text","elCertificateBrowser","querySelector","elThemes","catch","error","console","log","btnLoadMore","textBtnLoadMore","textContent","elTarget","localize_lp_cer_js","i18n","loading","dataSend","JSON","parse","send","args","paged","parseInt","stringify","url","lpDataAdmin","lp_rest_url","callBack","success","response","elAddNewTheme","status","message","data","elTmp","createElement","innerHTML","content","elListCertificates","insertAdjacentElement","total_pages","buildCanvas","completed","window","lpAJAXG","fetchAPI","el_lp_data_config_cer","data_config_cer","id_div_parent","getAttribute","LP_Certificate","node","functions","before","json","err","finally","lpGetCurrentURLNoParam","currentUrl","location","href","hasParams","includes","split","lpAddQueryArgs","endpoint","URL","Object","keys","arg","searchParams","set","listenElementViewed","callback","observerSeeItem","IntersectionObserver","entries","entry","isIntersecting","observe","observerCreateItem","MutationObserver","mutations","mutation","addedNodes","nodeType","childList","subtree","$","mediaSelector","__onSelect","__multiple","__context","activeFrame","frame","extend","k","Math","random","_frame","wp","media","title","button","button_text","multiple","state","on","select","source","get","single","toJSON","call","open","context","onSelect","f","ready","_","now","Date","getTime","debounce","func","wait","immediate","timeout","timestamp","result","later","last","setTimeout","apply","arguments","callNow","lpCertificatesSettings","$LP_Certificates","Vue","template","dragover","viewport","width","height","templateWidth","templateHeight","ratio","$view","$layerOptions","loaded","computed","getMaxWidth","created","that","init","methods","$img","$img_preload","initCanvas","initDragAndDrop","length","naturalWidth","naturalHeight","updateView","ajaxUpdateTemplate","trigger","options","name","updateActiveLayer","timer","clearTimeout","type","centerH","centerV","center","$layer","findLayer","$canvas","setActiveObject","is","deleteLayer","$layers","getObjects","i","addCustomPreview","getActiveLayer","position","top","abs","scaleY","originY","setCoords","left","scaleX","originX","confirm","confirm_remove_layer","http","post","layer","emulateJSON","params","children","filter","getActiveObject","w","prop","setLayerProp","renderAll","ajaxUpdateLayer","calculate","maxWidth","css","addClass","removeClass","setHeight","setWidth","setZoom","calcOffset","selector","$el","find","getLayerOptions","toObject","getExtendedFields","_fields","fields","triggerHandler","showControls","showLines","hideLines","toFixedX","num","ceil","hideControls","getLayers","layers","$objects","ajaxUpdateLayers","loadSettings","isPlainObject","hash","md5","hasClass","html","ajaxLoadLayer","show","addLayerList","$l","prepend","addLayer","setActive","createLayer","defaults","fontSize","lineHeight","fontFamily","uniqueId","fieldType","variable","$object","fabric","Text","qr_size","is_url","test","qr_code","Image","crossOrigin","src","borderColor","cornerColor","cornerSize","transparentCorners","padding","each","v","$_object","updateLayerOptions","$opt","val","undefined","fill","isNaN","flipX","flipY","replace","onObjectSelected","layerOptions","onObjectMoving","event","onObjectRotating","angle","setPropSlider","onObjectMouseup","onObjectMousedown","onBeforeSelectionCleared","hide","onObjectModified","limitObjectScale","siblings","slider","Canvas","selection","draggable","helper","drag","ui","targetOffset","offset","updateLines","droppable","over","out","drop","parentOffset","outerWidth","outerHeight","addLayerByDrop","trim","sortable","axis","start","$children","item","index","update","$obj","oldPosition","newPosition","sendBackwards","bringForward","updateRulers","end","s4","floor","toString","substring","selectTemplate","sizes","full","setPreview","alert","jQuery"],"sourceRoot":""}